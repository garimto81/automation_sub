# PRD-0003: Caption Generation Workflow System - Checklist

**PRD**: [0003-prd-caption-workflow.md](../../tasks/prds/0003-prd-caption-workflow.md)
**Created**: 2025-12-25
**Last Updated**: 2025-12-25

---

## Overall Progress

| Phase | Status | Progress |
|-------|--------|----------|
| Phase 0: Infrastructure | Not Started | 0% |
| Phase 1: Pre-Production Pipeline | Not Started | 0% |
| Phase 2: Live Data Pipeline | Not Started | 0% |
| Phase 3: Auto-Generation Pipeline | Not Started | 0% |
| Phase 4: Graphics Trigger Integration | Not Started | 0% |
| Phase 5: AI Integration & Optimization | Not Started | 0% |

**Total Progress**: 0%

---

## Phase 0: Infrastructure Extension (1주)

### Database Migration
- [ ] `venues` 테이블 생성
- [ ] `events` 테이블 생성
- [ ] `tournaments` 테이블 생성
- [ ] `players` 테이블 생성
- [ ] `player_profiles` 테이블 생성
- [ ] `player_stats` 테이블 생성
- [ ] `chip_history` 테이블 생성
- [ ] `hand_actions` 테이블 생성
- [ ] `payouts` 테이블 생성
- [ ] `blind_levels` 테이블 생성
- [ ] `graphics_queue` 테이블 생성
- [ ] `commentators` 테이블 생성
- [ ] `schedules` 테이블 생성
- [ ] 인덱스 생성 및 검증

### Event Type Definition
- [ ] `CaptionEventType` enum 정의
- [ ] Event Bus 연동 (PRD-0002)
- [ ] 8개 핵심 이벤트 등록

### Agent Interface
- [ ] `DataCollectionAgent` 기본 인터페이스 정의
- [ ] `GraphicsTriggerAgent` 기본 인터페이스 정의
- [ ] PRD-0002 `BaseAgent` 상속 구현

---

## Phase 1: Pre-Production Pipeline (2주)

### PreProductionAgent
- [ ] Agent 기본 구조 구현
- [ ] 초기화 로직 구현
- [ ] 이벤트 처리 로직 구현

### Player Profile Import
- [ ] Hendon Mob 크롤러 구현
- [ ] 배치 CSV 임포트 구현
- [ ] 이미지 다운로드 로직
- [ ] player_profiles 테이블 연동
- [ ] 수동 입력 UI (Control Panel)

### Payout Structure Import
- [ ] CSV 파서 구현
- [ ] payouts 테이블 연동
- [ ] 수동 편집 UI

### Event/Venue Setup
- [ ] events 테이블 CRUD
- [ ] venues 테이블 CRUD
- [ ] 설정 UI

### Blind Structure Import
- [ ] CSV 파서 구현
- [ ] blind_levels 테이블 연동
- [ ] 레벨 미리보기 UI

---

## Phase 2: Live Data Pipeline (3주)

### LiveDataAgent
- [ ] Agent 기본 구조 구현
- [ ] RFID 데이터 수신 로직
- [ ] 데이터 파싱 로직
- [ ] PRD-0002 RFIDParserAgent 연동

### ChipHistoryTracker
- [ ] 칩 변동 감지 로직
- [ ] chip_history 자동 기록
- [ ] BB 환산 계산
- [ ] 평균 스택 대비 % 계산

### BlindLevelTimer
- [ ] 타이머 구현
- [ ] 레벨 자동 전환
- [ ] `level_change` 이벤트 발생
- [ ] 브레이크 관리

### FeatureTableManager
- [ ] 피처 테이블 플레이어 관리
- [ ] `feature_table_change` 이벤트 발생
- [ ] Control Panel 연동

### Manual Input UI
- [ ] 플레이어 칩 수동 입력
- [ ] 좌석/테이블 변경
- [ ] 탈락 처리

---

## Phase 3: Auto-Generation Pipeline (2주)

### AutoGeneratorAgent
- [ ] Agent 기본 구조 구현
- [ ] 이벤트 구독 로직
- [ ] 계산 스케줄링

### StatsCalculator
- [ ] VPIP 계산 로직
- [ ] PFR 계산 로직
- [ ] Aggression Factor 계산
- [ ] player_stats 테이블 업데이트
- [ ] 극단 수치 감지 알림

### ChipFlowGenerator
- [ ] 최근 N핸드 조회 로직
- [ ] 트렌드 계산
- [ ] 캐싱 전략 구현

### RankCalculator
- [ ] 순위 계산 로직
- [ ] 순위 변동 (▲▼) 계산
- [ ] 실시간 업데이트

### PayoutTracker
- [ ] 현재 버블 라인 추적
- [ ] 다음 페이점프 계산
- [ ] At Risk 금액 계산

---

## Phase 4: Graphics Trigger Integration (2주)

### GraphicsTriggerAgent
- [ ] Agent 기본 구조 구현
- [ ] 이벤트-그래픽 매핑 정의
- [ ] 우선순위 로직

### EventListenerAgent
- [ ] DB 변경 감지 (PostgreSQL LISTEN/NOTIFY)
- [ ] 이벤트 발생 로직
- [ ] 디바운싱 구현

### QueueManagerAgent
- [ ] graphics_queue 관리
- [ ] 우선순위 정렬
- [ ] 상태 관리 (pending → rendered → displayed)
- [ ] 자동 정리 로직

### PRD-0001 Frontend 연동
- [ ] WebSocket 그래픽 호출
- [ ] 자막 데이터 포맷 정의
- [ ] 26개 자막 유형별 포맷터

---

## Phase 5: AI Integration & Optimization (2주)

### PriorityDecisionAgent
- [ ] GPT-4o-mini 연동
- [ ] Day별 비율 자동 조절
- [ ] 컨텍스트 기반 우선순위

### StoryDetectionAgent 연동
- [ ] PRD-0002 AI Agent 통합
- [ ] 하이라이트 제안 연동

### Dashboard Integration
- [ ] 실시간 워크플로우 모니터링
- [ ] 데이터 수집 상태 표시
- [ ] 에러 로그 표시

### Performance Optimization
- [ ] 쿼리 튜닝
- [ ] 인덱스 최적화
- [ ] 캐싱 전략 적용
- [ ] 로드 테스트

---

## Validation Checklist

### Data Collection
- [ ] Pre-Production 데이터 100% 수집 확인
- [ ] Live 데이터 지연 < 2초 확인
- [ ] Auto 계산 정확도 > 99% 확인

### Graphics Trigger
- [ ] 8개 이벤트 트리거 테스트
- [ ] 26개 자막 유형 렌더링 테스트
- [ ] 우선순위 동작 확인

### Integration
- [ ] PRD-0001 Frontend 연동 확인
- [ ] PRD-0002 Agent 연동 확인
- [ ] OBS Browser Source 테스트

---

## Notes

- Phase 0은 PRD-0001 Phase 1 완료 후 시작
- Phase 2의 RFID 연동은 현장 장비 의존
- Phase 5의 AI 비용 예산 확인 필요

---

## References

| Document | Path |
|----------|------|
| PRD-0003 | `tasks/prds/0003-prd-caption-workflow.md` |
| Data Flow Diagram | `docs/images/caption-data-flow.png` |
| Agent Hierarchy | `docs/images/caption-agent-hierarchy.png` |
| DB ERD | `docs/images/caption-db-erd.png` |
